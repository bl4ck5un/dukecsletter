%% Adopted from culetter.sty

\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{dukecsletter}[2021/11/30 Duke CS letterhead]
\RequirePackage{graphicx}

\def\logo{                      %create Logo and from address
\null\vspace{-80pt}\begingroup

\begin{minipage}{3in}\sulogo \end{minipage}

\vspace{10pt}

\fromaddress

\endgroup\par}

\def\completeaddress{\hbox{\vtop{\hsize=.6\textwidth\small\rm%
                   \fromaddress}}\hfill
                   \hbox{\@date}}

\def\sendername{\fromname}

%create default address
\def\fromaddress{
{\bf \sendername}, \fromtitle \hfill \faPhone~\telephonenum \\
\deptname \hfill \faEnvelopeO~\emailaddr \\
\fromlocation \hfill \faHome~\websiteurl}


%+cm
\DeclareOption{no-name}{\def\sendername{}}
\DeclareOption{widelogo}{\def\sulogo
        {\includegraphics[width=3.4in]{duke-univ-cs-dept-logo-new-white-text-blue-bkgrd-banner.jpeg}}}
\DeclareOption{squarelogo}{\def\sulogo
        {\includegraphics[height=.92in]{duke-univ-cs-dept-logo-new-vert-white-text-blue-bkgrd.png}}}
\DeclareOption{no-logo}{\def\logo{}}
\DeclareOption{britdate}{\renewcommand*{\today}{\number\day\space
   \ifcase\month\or
   January\or February\or March\or April\or May\or June\or
   July\or August\or September\or October\or November\or December\fi
   \space\number\year}}

\DeclareOption{rightalignedaddress}{\def\fromaddress{
        \hfill\begin{tabular}{l}
                \sendername \\
                \fromtitle \\
                \deptname \\
                \universityname \\
                \fromlocation \\
                \emailaddr \\
                \websiteurl \\
        \end{tabular}}}

\ProcessOptions

% increase the indent for right stuff a little to 55%
\longindentation=.55\textwidth
\indentedwidth=\textwidth
\advance\indentedwidth -\longindentation
%-cm

\newcommand*{\department}[1]{\def\deptname{#1}}
\newcommand*{\university}[1]{\def\universityname{#1}}
\newcommand*{\mailcode}[1]{\def\mailcodenum{#1}}
\newcommand*{\zipcode}[1]{\def\zipcodenum{#1}}
\newcommand*{\proftitle}[1]{\def\fromtitle{#1}}
\newcommand*{\website}[1]{\def\websiteurl{#1}}
\newcommand*{\email}[1]{\def\emailaddr{#1}}

\mailcode{}
\zipcode{14853}
\department{Department of Mathematics}
\location{Malott Hall}
\telephone{+1-607-255-4013}
\proftitle{}
\website{}
\email{}

%customization for letter format
\oddsidemargin   25pt      % Left margin on odd-numbered pages.
\evensidemargin  25pt      % Left margin on even-numbered pages.
\textwidth 417pt
\topmargin -6pt




\def\ps@headings{\def\@oddhead{\rm To \ignorespaces\toname \hfil \today
    \hfil Page \thepage}\def\@oddfoot{}}

\def\@texttop{\vskip 0pt}

\def\opening#1{\logo %Create all up to start of
  \vspace{20pt}%
  \@date
  \vskip 1pt
  \thispagestyle{empty}
  \vspace{\parskip}
  %{\raggedright \toname \\ \toaddress \par}%
  %\vspace{1.25\parskip}%
  #1\par\nobreak}

